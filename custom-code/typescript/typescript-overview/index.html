<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="PlasmaDev">
    <link rel="canonical" href="https://plasmaengine.github.io/PlasmaDocs/custom-code/typescript/typescript-overview/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Custom Code with TypeScript - PlasmaDocs</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Custom Code with TypeScript", url: "#_top", children: [
              {title: "Editing TypeScript Code", url: "#editing-typescript-code" },
              {title: "Extending the Engine with TypeScript", url: "#extending-the-engine-with-typescript" },
              {title: "Instantiating TypeScript Components", url: "#instantiating-typescript-components" },
              {title: "Compiling TypeScript Code", url: "#compiling-typescript-code" },
              {title: "Messaging", url: "#messaging" },
              {title: "Functionality Available in TypeScript", url: "#functionality-available-in-typescript" },
              {title: "See Also", url: "#see-also" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../visual-script/script-component/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../visual-script/script-component/" class="btn btn-xs btn-link">
        Script Component
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../ts-messaging/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../ts-messaging/" class="btn btn-xs btn-link">
        Messaging in TypeScript Code
      </a>
    </div>
    
  </div>

    

    <h1 id="custom-code-with-typescript">Custom Code with TypeScript</h1>
<p><a href="https://www.typescriptlang.org">TypeScript</a> (TS) is a language that is built on top of JavaScript. All JavaScript is valid TypeScript, but additionally TypeScript allows you to use strong typing to improve your coding experience. The TypeScript code itself is never executed, instead it is <em>transpiled</em> from TypeScript into pure JavaScript, and then interpreted by a regular JavaScript interpreter.</p>
<p>The benefit of using TypeScript is mostly in ease of use. You can edit TypeScript code with any text editor. However, plEditor assumes that you have <a href="https://code.visualstudio.com/download">Visual Studio Code</a> (VSC) installed. When you open a TS file from the editor, it will open an entire <em>workspace</em> in VSC, which contains references to all your project's <a href="../../projects/data-directories.md">data directories</a>. This enables VSC to give you full code-completion and type-checking functionality.</p>
<h2 id="editing-typescript-code">Editing TypeScript Code</h2>
<p>Providing a decent text editing experience for code is difficult. Therefore plEditor doesn't even attempt to. All code editing has to be done in an external editor, usually meaning Visual Studio Code.</p>
<p>For details see the <a href="../ts-asset/">TypeScript asset</a>.</p>
<h2 id="extending-the-engine-with-typescript">Extending the Engine with TypeScript</h2>
<p>The TypeScript integration allows you to create <a href="../custom-ts-components/">custom components</a>. TypeScript components can interact both with each other, as well as with C++ components. The APIs available to TypeScript code are deliberately very similar to their C++ counterparts, to make it easy to migrate a TypeScript component to C++, if the need arises.</p>
<p>At the moment you can't use TypeScript to write things like custom <a href="../../../runtime/application/game-state/">game states</a>.</p>
<h2 id="instantiating-typescript-components">Instantiating TypeScript Components</h2>
<p>TypeScript code is executed through the <a href="../ts-component/">TypeScript component</a>. This is effectively a C++ component which forwards everything of relevance to script code and back. Therefore you never add a script directly to a <a href="../../../runtime/world/game-objects/">game object</a>, instead you attach a TypeScript component, which then references the desired script.</p>
<h2 id="compiling-typescript-code">Compiling TypeScript Code</h2>
<p>All functionality that TypeScript provides over JavaScript is technically possible to do with pure JavaScript, it is just very cumbersome. Therefore any piece of TypeScript can be transformed to (more complex) JavaScript code. This step is called <em>transpiling</em>.</p>
<p>All script code in a project has to be fully transpiled before a scene can be simulated. Therefore <a href="../../../editor/run-scene/">running a scene</a> always triggers the transpilation step. Since the TypeScript transpiler is itself written in JavaScript and therefore executed in a JavaScript virtual machine, this step is unfortunately quite slow, especially for larger files. All results are cached, though, so only modified files ever need to be transpiled again.</p>
<p>Note that C++ reflection information is used to expose C++ components, enums, and messages to TypeScript, meaning that certain changes of C++ code can also trigger re-transpilation of some TypeScript files.</p>
<h2 id="messaging">Messaging</h2>
<p>TypeScript code can use <a href="../../../runtime/world/world-messaging/">messages</a> to communicate both with other TS components as well as with C++ components. TypeScript code can <em>handle</em> any message, and it can <em>send</em> (or <em>post</em>) any message. To communicate with another TS component, you can define custom message types directly in script code. To communicate with a C++ component, only C++ messages can be used, as the C++ code has no means to know and handle a TypeScript message. If necessary to do so, the custom message type has to be defined in C++.</p>
<p>See <a href="../ts-messaging/">Messaging in TypeScript Code</a> for details.</p>
<h2 id="functionality-available-in-typescript">Functionality Available in TypeScript</h2>
<p>The TypeScript binding is a mixture of auto-generated code and hand-crafted APIs specifically tailored to provide a smooth experience.</p>
<h3 id="auto-generated-code">Auto-Generated Code</h3>
<p>Where possible <a href="../../../runtime/reflection-system/">reflection information</a> is used to automatically generate the necessary TypeScript code to give Visual Studio Code the needed information for code-completion and error-checking. This is, for example, used to expose all C++ components, enums, flags, and messages. The generated TS code is stored in each project in the folder <code>TypeScript/pl</code> and you will notice that for instance the file <code>AllComponents.ts</code> is re-transpiled when a C++ component is added.</p>
<p>Consequently, for things like messages and components, only reflected parts can be available to TypeScript. For components this is obvious, as only reflected parts will show up in the editor UI as well, but for messages you may come across a C++ message for which members are missing in the TS version, as reflecting message properties is technically not necessary for the message to work. If you do need that message on the TypeScript side, you need to add the proper reflection information.</p>
<p>Additionally, not all kinds of reflected properties are currently supported for TypeScript. <em>Array</em>, <em>map</em> and <em>set</em> properties are not available, as well as <em>game object handles</em> and <em>component handles</em>. Such reflected properties are simply not included in the auto-generated TS code.</p>
<h3 id="hand-crafted-code">Hand-Crafted Code</h3>
<p>Although auto-generating code is the most convenient to keep large amounts of code in sync, there are limits what can be done. TypeScript and C++ are often very different and to not compromise the usability or performance of either side, the way some aspects are exposed to TypeScript has to be chosen carefully.</p>
<p>Basic types such as the math classes (Vec2, Vec3, Mat4, Quat, ...) have been designed to be very similar to their C++ counterparts. However, a big design goal was to minimize the amount of temporaries ('garbage') produced when using them, as this has a significant impact on performance. Therefore, using those classes you will notice that their functions often work 'in place', instead of returning a modified clone. Additionally, TypeScript doesn't support function overloading, which is why the TypeScript variants of <code>pl.Vec3</code>, etc use more explicit function names for disambiguation.</p>
<p>Finally, bindings for larger systems, such as <a href="../../../runtime/world/worlds/">worlds</a> or <a href="../../physics/jolt/jolt-overview.md">physics</a> are also built by hand. Here, exposing the C++ API 1:1 to TypeScript would simply not yield a good user experience. Instead, the TypeScript binding is fine tuned to expose useful functionality, and to hide pointless complexity. If you need full control over every aspect, there is no way around using C++ anyway. Consequently, if you decide that scripting is fine for your use case, the binding tries to make this as convenient as possible.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="https://www.typescriptlang.org">TypeScript</a></li>
<li><a href="https://code.visualstudio.com">Visual Studio Code</a></li>
<li><a href="../../custom-code-overview/">Custom Code</a></li>
<li><a href="../ts-asset/">TypeScript Asset</a></li>
<li><a href="../custom-ts-components/">Custom Components with TypeScript</a></li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../visual-script/script-component/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../visual-script/script-component/" class="btn btn-xs btn-link">
        Script Component
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../ts-messaging/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../ts-messaging/" class="btn btn-xs btn-link">
        Messaging in TypeScript Code
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
</footer>

</body>
</html>