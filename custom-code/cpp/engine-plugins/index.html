<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="PlasmaDev">
    <link rel="canonical" href="https://plasmaengine.github.io/PlasmaDocs/custom-code/cpp/engine-plugins/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Engine Plugins - PlasmaDocs</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Engine Plugins", url: "#_top", children: [
              {title: "Creating a Plugin", url: "#creating-a-plugin" },
              {title: "Loading a Plugin", url: "#loading-a-plugin" },
              {title: "Add Custom Code", url: "#add-custom-code" },
              {title: "Utility Plugins", url: "#utility-plugins" },
              {title: "See Also", url: "#see-also" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../game_logic/forward-events-to-game-state-component/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../game_logic/forward-events-to-game-state-component/" class="btn btn-xs btn-link">
        Forward Events To Game State Component
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../custom-cpp-component/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../custom-cpp-component/" class="btn btn-xs btn-link">
        Custom Components with C++
      </a>
    </div>
    
  </div>

    

    <h1 id="engine-plugins">Engine Plugins</h1>
<p>Engine plugins are the best way to get your custom code into the engine, such that it is accessible by the editor and also <a href="../../../tools/player/">plPlayer</a>.</p>
<p>Contrary to using a plugin, you could also build your own <a href="../../../runtime/application/application/">application (TODO)</a>, which may link to static libraries that contain your code. However, that approach means that your code cannot be loaded into the editor process and therefore you won't be able to leverage those tools to their full extent. We strongly advise against that.</p>
<h2 id="creating-a-plugin">Creating a Plugin</h2>
<p>The easiest way to create a custom plugin is to use the <a href="../cpp-project-generation/">C++ Project Generation</a>. This will create a template project for you, set up the CMake files for your build and configure the <a href="../../projects/plugin-selection.md">plugin selection</a>.</p>
<h3 id="creating-a-plugin-manually">Creating a Plugin Manually</h3>
<p>In case you want more control, you can also set up your game plugin manually. The <a href="../../../samples/sample-game-plugin.md">Sample Game Plugin</a> is a good reference for how to do that. To just create a plugin, at all, you only need very little setup.</p>
<p>The only files you need to look at are:</p>
<ul>
<li><code>CMakeLists.txt</code></li>
<li><code>SampleGamePluginDLL.h</code></li>
<li><code>SampleGamePlugin.cpp</code></li>
</ul>
<h3 id="build-system-setup">Build System Setup</h3>
<p>The file <code>CMakeLists.txt</code> is only of interest here in case you want to reuse the Plasma build infrastructure to generate your library. If you use <a href="../../../build/submodule/">Plasma Engine as a Submodule</a> then you probably have your own CMake scripts. Either way, you need to add a project that generates a DLL.</p>
<h3 id="dll-symbol-importexport">DLL Symbol Import/Export</h3>
<p>The file <code>SampleGamePluginDLL.h</code> only contains <code>#define</code>s for DLL import/export macros.</p>
<!-- BEGIN-DOCS-CODE-SNIPPET: dll-export-defines -->

<pre><code class="language-cpp">// Configure the DLL Import/Export Define
#if PLASMA_ENABLED(PLASMA_COMPILE_ENGINE_AS_DLL)
#  ifdef BUILDSYSTEM_BUILDING_SAMPLEGAMEPLUGIN_LIB
#    define PLASMA_SAMPLEGAMEPLUGIN_DLL __declspec(dllexport)
#  else
#    define PLASMA_SAMPLEGAMEPLUGIN_DLL __declspec(dllimport)
#  endif
#else
#  define PLASMA_SAMPLEGAMEPLUGIN_DLL
#endif
</code></pre>
<!-- END-DOCS-CODE-SNIPPET -->

<p>If your plugin will be entirely on its own, you don't even need this. However, if you want to use multiple plugins and some of them should contain shared code, then others need to be able to link against the shared libraries and access classes and functions from that library. By tagging classes with these macros you can <em>export</em> symbols from a DLL and thus make those things available to other code. For examples how to use this, just search the sample plugin.</p>
<h3 id="plugin-callbacks">Plugin Callbacks</h3>
<p>Plasma provides additional hooks for initialization when a plugin gets loaded or unloaded. You can find these in <code>SampleGamePlugin.cpp</code>:</p>
<!-- BEGIN-DOCS-CODE-SNIPPET: plugin-setup -->

<pre><code class="language-cpp">PLASMA_PLUGIN_ON_LOADED()
{
  // you could do something here, though this is rare
}

PLASMA_PLUGIN_ON_UNLOADED()
{
  // you could do something here, though this is rare
}
</code></pre>
<!-- END-DOCS-CODE-SNIPPET -->

<p>These callbacks are optional, though in some cases you may want to register and unregister things here. However, it is way more common to rather use the <a href="../../../runtime/configuration/startup/">startup system</a> instead.</p>
<h2 id="loading-a-plugin">Loading a Plugin</h2>
<p>If you want to load a plugin from code, you would use <code>plPlugin::LoadPlugin()</code> and provide only the name (no path) of your plugin. Make sure that the DLL is stored in the same directory as all other DLLs and EXEs.</p>
<p>The more convenient way to load your game plugin, though, is to enable it in the <a href="../../projects/plugin-selection.md">project settings</a>. Then it will be automatically loaded by every <a href="../../../runtime/application/application/">application (TODO)</a>.</p>
<h2 id="add-custom-code">Add Custom Code</h2>
<p>Once you have your basic plugin set up and can load it into your project, you can start adding custom code. The easiest way to get started is to write a <a href="../custom-cpp-component/">custom component</a>. Once you need control over higher level game logic, you can add your own <a href="../../../runtime/application/game-state/">game state</a>. And if you need to initialize and shut down certain systems, you should utilize the <a href="../../../runtime/configuration/startup/">startup system</a>.</p>
<h2 id="utility-plugins">Utility Plugins</h2>
<p>If you want to write a plugin that provides some functionality for shared access, like some integration of a third-party library, the process is exactly the same. The only difference is, that such libraries would never contain a <a href="../../../runtime/application/game-state/">game state</a>.</p>
<p>Also, have a look at <a href="../../../runtime/configuration/interfaces/">singletons</a> if your plugin is supposed to provide an implementation of some abstract interface.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="../../../samples/sample-game-plugin.md">Sample Game Plugin</a></li>
<li><a href="../../../runtime/application/game-state/">Game States</a></li>
<li><a href="../custom-cpp-component/">Custom Components with C++</a></li>
<li><a href="../../../runtime/configuration/startup/">Startup System</a></li>
<li><a href="../../../runtime/configuration/interfaces/">Singleton Interfaces</a></li>
</ul>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../../game_logic/forward-events-to-game-state-component/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../../game_logic/forward-events-to-game-state-component/" class="btn btn-xs btn-link">
        Forward Events To Game State Component
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../custom-cpp-component/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../custom-cpp-component/" class="btn btn-xs btn-link">
        Custom Components with C++
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/noraj/mkdocs-windmill-dark">Windmill Dark</a> theme by Alexandre ZANNI (noraj).</p>
</footer>

</body>
</html>